# MongoDB 속도 문제
- 현상: 시청자 목록을 조회하여 가져오는 API가 800명대일 경우 4초 이상 걸림
- 원인 추측
  1. 쿼리 문제
  ⇒ 쿼리가 문제라기에는 개발계/운영계 소스 코드가 똑같고 linq slow query problem 관련 해결법에서 해당하는 내용이 없었음
  1. DB 조회 문제
  ⇒ DB 데이터 양의 차이가 다름, 그래서 같은 데이터의 양을 조회하더라도 개발계에서는 빠르게 찾아내는 반면 운영계에서는 오래 걸림
  ⇒ MongoDB를 쓰는데 NoSQL 특성 상 특정 필드의 값을 찾으려고 하면 모든 콜렉션의 값들을 다 찾아보게 되어 있어서 시간이 아주 오래 걸림
  ⇒ 영상 키 값을 인덱스하여 영상 키 값으로 먼저 데이터를 조회할 수 있게 함
  ⇒ 기존 4초대에서 0.337초로 줄어들었음

- MongoDB Index 설정 방법
  - 인덱스 설정 방법은 MongoDB Compass를 이용하면 아주 간단
  - MongoDB Compass에서 indexes 탭 눌러서 추가하면 끝
- 인덱스 설정이 무조건 좋은 것은 아님
    - DB서버를 켜면 인덱스를 전부 메모리에 올려놓는다.
    데이터가 적다면 인덱스를 추가해도 속도에 메리트는 없으면서 메모리만 차지한다.
    - 또한 CRUD 에서 인덱스가 생성되면 Read는 빨라지더라도 나머지 CUD는 느려진다.
    이유는 저장할 때도 위치에 맞춰서 저장을 해주어야 하기 때문이다.
    - 좋은 인덱스는 중복이 없으면서 전체데이터의 5% 정도 걸러지면 좋다고 한다.